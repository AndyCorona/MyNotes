# 第一章 版本控制工具简介

### 1.1 什么是版本控制

版本控制是一种记录若干文件内容变化的系统。

### 1.2 本地版本控制系统

最简单的版本控制是不借助于工具，直接复制整个项目目录来保存不同的版本。借助版本控制工具，如 rcs，可以保存并管理指定项目的文件补丁，文件补丁记录着文件修订前后的变化内容。但本地版本控制系统不适合于协作开发。

### 1.3 集中化版本控制系统

用一个服务器专门保管项目文件就是集中化版本控制。协作开发的开发者通过客户端连接服务器，取出最新的文件或提交更新后的新文件。如 CVS. Subversion 等工具。但集中化版本控制系统高度依赖服务器，若服务器出现问题，小则无法获取或更新文件，大则无法恢复丢失的数据。

### 1.4 分布式版本控制系统

如 Git, Mercurial, Bazaar 等系统，客户端不仅仅是拷贝单个或多个文件，而是把服务器上整个项目的文件拷贝下来。服务器发生故障后，任何一个开发者都拥有故障前的完整项目文件，可以快速恢复。

### 1.5 Git 基础要点

#### 1.5.1 不同的工作原理
Git 和其他分布式版本控制系统的主要差别在于，大多数其他系统只关心文件内容的差异，只记录文件内容有变化的文件，不记录文件内容不变的文件（如图一）。而 Git 不保存文件内容的差异，无论文件内容是否发生改变，Git 会记录项目中的所有指定文件（如图二）。

![其他版本控制工具](E:\BaiduNetdiskDownload\Typora\Git\01版本控制工具简介.assets\QQ截图20210817211156.png)
图一、其他版本控制系统的工作原理
![Git](E:\BaiduNetdiskDownload\Typora\Git\01版本控制工具简介.assets\QQ截图20210817211205.png)
图二、Git 的工作原理

#### 1.5.2 唯一标识符
在保存到 Git 之前，所有数据都要使用 SHA-1 算法进行内容的校验和计算，通过对文件内容和目录结构计算出一个 SHA-A 哈希值，作为该数据的唯一标识，而不是文件名。该哈希值字符串由 40 个十六进制字符组成。

#### 1.5.3 三种状态
对于任何一个已跟踪的文件，在 Git 内只有三种状态：已提交(committed)、已修改(modified)和已暂存(staged)。已提交表示文件已经被安全地保存在本地仓库中。已修改表示修改了文件，但还没有提交保存。已暂存表示把已修改地文件放在下次提交时要保存地清单中。
每个项目都有一个 .git 目录，保存元数据和对象数据库，是项目多个版本的仓库。从仓库里取出某个版本的所有文件和目录，用以进行后续工作的目录叫做工作目录。
在工作目录对文件进行修改，多个文件暂存到暂存区，最后一起提交到仓库中。

### 1.6 首次配置 Git

/etc/gitconfig 文件中的配置对系统中所有用户都有效。使用 git config --system 命令时，就是读写此文件，此文件位于Git 安装目录下。
~/.gitconfig 文件中的配置对单个用户有效。使用 git config --global 命令时，就是读写此文件。此文件位于用户家目录下。
.git/config 文件 文件对当前项目有效。使用 git config 命令时，就是读写此文件。此文件位于 .git 目录下。
和 maven 三层配置文件类似，局部配置优于全局配置。

#### 1.6.1 用户信息
每次 Git 提交时都会使用开发者用户名称和电子邮件地址。
```dos
git config --global user.name "Andy Corona"
git config --global user.emai andycorona@gmial.com
```

#### 1.6.2 文本编辑器
默认使用操作系统指定的编辑器，可以重新设置。
```dos
git config --global core.editor vim
```

#### 1.6.3 差异分析工具
配置在解决合并冲突时使用的差异分析工具
```dos
git config --global merge.tool vimdiff
```

#### 1.6.4 查看配置信息
查看已有的配置信息，使用 ```git config --list``` 命令，有时候会看到重复的变量名，说明它们来自不同的配置文件。```git config user.name``` 直接查看 user.name 环境变量的值。

#### 1.6.5 获取帮助
以下三种方式都可以获得 config 命令的帮助
```dos
git help config
git config --help
man git -config
```